module.exports = {
  config: {
    name: "brithday",
    version: "1.0.5",
    author: "Shahadat SAHU & Gemini",
    countDown: 5,
    role: 0,
    shortDescription: { en: "Wish someone a happy birthday with a series of messages" },
    category: "fun",
    guide: { en: "{pn} @mention or reply to someone" }
  },

  onStart: async function ({ api, event }) {
    const { threadID, messageID, mentions, messageReply } = event;
    let targetID, name;

    // ‡ßß. ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶Ü‡¶á‡¶°‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶®‡¶æ‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ (‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Æ‡ßá‡¶®‡¶∂‡¶®)
    if (messageReply) {
      targetID = messageReply.senderID;
      // ‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ ‡¶Ö‡¶®‡ßá‡¶ï ‡¶∏‡¶Æ‡ßü ‡¶ï‡¶†‡¶ø‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá, ‡¶§‡¶æ‡¶á ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü '‡¶™‡ßç‡¶∞‡¶ø‡ßü' ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡•§
      name = "‡¶™‡ßç‡¶∞‡¶ø‡ßü"; 
    } else if (Object.keys(mentions).length > 0) {
      targetID = Object.keys(mentions)[0];
      name = mentions[targetID].replace("@", "");
    } else {
      return api.sendMessage("üéÇ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶æ‡¶ï‡ßá ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ ‡¶ú‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶§‡¶æ‡¶ï‡ßá ‡¶Æ‡ßá‡¶®‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú‡ßá ‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶¶‡¶ø‡¶®! ü•∞", threadID, messageID);
    }

    const arraytag = [{ id: targetID, tag: name }];

    const sendMessage = (msg) => {
      api.sendMessage({ body: msg, mentions: arraytag }, threadID);
    };

    // ‡ß®. ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ
    const messages = [
      { delay: 0, msg: `‡¶¨‡¶∏ ‡¶Ü‡¶Ø‡¶º‡¶æ‡¶® ‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑ ‡¶•‡ßá‡¶ï‡ßá ‡¶§‡ßã‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ, @${name}!\nüéâ HAPPY BIRTHDAY üéâ` },
      { delay: 3000, msg: `‡¶Ü‡¶∞‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶õ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶™‡¶æ‡¶∞‡•§ ‡¶∏‡ßÅ‡¶∏‡ßç‡¶• ‡¶•‡¶æ‡¶ï‡ßã, ‡¶≠‡¶æ‡¶≤‡ßã ‡¶•‡¶æ‡¶ï‡ßã ‡¶è‡¶á ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ‡¶á ‡¶ï‡¶∞‡¶ø ‡¶¨‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶∞!\nü•∞ ‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® ü•∞ @${name}` },
      { delay: 6000, msg: `‡¶Ü‡¶®‡¶®‡ßç‡¶¶ ‡¶â‡¶≤‡ßç‡¶≤‡¶æ‡¶∏‡ßá ‡¶ï‡¶æ‡¶ü‡ßá ‡¶Ø‡ßá‡¶® ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶¶‡¶ø‡¶®, ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ ‡¶ú‡¶æ‡¶®‡¶æ‡¶á ‡¶Ü‡¶ú ‡¶§‡ßã‡¶Æ‡¶æ‡¶Ø‡¶º!\nü•∞ ‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® üòç @${name}` },
      { delay: 10000, msg: `‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ ‡¶®‡¶ø‡¶ì ‡¶™‡ßç‡¶∞‡¶ø‡¶ì~\n‡¶Ø‡¶¶‡¶ø‡¶ì ‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡¶ø‡¶§, ‡¶¨‡¶æ‡¶∞‡ßç‡¶•‡¶°‡ßá ‡¶ü‡ßç‡¶∞‡¶ø‡¶ü ‡¶™‡ßá‡¶≤‡ßá ‡¶¨‡ßé‡¶∏ ‡¶π‡¶¨‡ßã ‡¶¨‡¶°‡¶º ‡¶™‡ßç‡¶∞‡ßÄ‡¶§!\nüåº ‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® üåº @${name}` },
      { delay: 14000, msg: `‡¶Ü‡¶ú ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá ‡¶Ü‡¶®‡¶®‡ßç‡¶¶ ‡¶ì ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶Æ‡ßÅ‡¶π‡ßÅ‡¶∞‡ßç‡¶§‡ßá ‡¶≠‡¶∞‡ßá ‡¶â‡¶†‡ßÅ‡¶ï ‡¶è‡¶á ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ‡¶á ‡¶ï‡¶∞‡¶ø ...‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® @${name}` },
      { delay: 18000, msg: `‡¶´‡ßÅ‡¶≤‡ßá ‡¶π‡¶æ‡¶Å‡¶∏‡¶ø‡¶§‡ßá ‡¶™‡ßç‡¶∞‡¶æ‡¶£‡ßá‡¶∞ ‡¶ñ‡ßÅ‡¶∂‡¶ø‡¶§‡ßá, ‡¶Ö‡¶≤‡¶ø‡¶∞‡¶æ ‡¶ó‡¶æ‡¶®‡ßá ‡¶ó‡¶æ‡¶®‡ßá ‡¶´‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶ï‡¶æ‡¶®‡ßá ‡¶ï‡¶æ‡¶®‡ßá, ‡¶¨‡¶≤‡¶õ‡ßá ‡¶Ü‡¶ú ‡¶∏‡ßá‡¶á ‡¶∂‡ßÅ‡¶≠ ‡¶¶‡¶ø‡¶®‡•§\n‚ù¶~‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®~‚ù¶ @${name}` },
      { delay: 22000, msg: `‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ ‡¶ï‡¶∞‡¶ø ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ø‡ßá‡¶® ‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ‡¶∞ ‡¶∏‡¶¨ ‡¶∏‡ßÅ‡¶ñ ‡¶Ü‡¶∏‡ßç‡¶¨‡¶æ‡¶¶‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßã‡•§\n‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® @${name}` },
      { delay: 26000, msg: `‡¶∂‡ßÅ‡¶≠ ‡¶π‡ßã‡¶ï ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ ‡¶¶‡¶ø‡¶®‡•§üíñ\n‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶ñ‡ßá‡¶∞ ‡¶π‡¶æ‡¶∏‡¶ø ‡¶Ø‡ßá‡¶® ‡¶∏‡¶æ‡¶∞‡¶æ‡¶ú‡ßÄ‡¶¨‡¶® ‡¶è‡¶Æ‡¶®‡¶ø ‡¶•‡¶æ‡¶ï‡ßÅ‡¶ï, ‡¶π‡ßç‡¶Ø‡¶æ‡¶™‡¶ø ‡¶¨‡¶æ‡¶∞‡ßç‡¶•‡¶°‡ßá‚ò∫Ô∏è @${name}` },
      { delay: 30000, msg: `‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ ‡¶®‡¶ø‡¶ì ‡¶™‡ßç‡¶∞‡¶ø‡¶Ø‡¶º @${name}!üéÇ\n‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶• ‡¶ö‡¶≤‡¶æ ‡¶π‡ßã‡¶ï ‡¶Ü‡¶®‡¶®‡ßç‡¶¶‡ßá‡¶∞, ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶∏‡¶æ‡¶´‡¶≤‡ßç‡¶Ø‡ßá‡¶∞‡•§` },
      { delay: 34000, msg: `Many many happy returns of the day ü•∞üòò\nHappy Birthday üéÇ @${name}` },
      { delay: 38000, msg: `‡¶Æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡ßã‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡¶ø‚Äå ‡¶∏‡¶¨‚Äå ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∏‡ßÅ‡¶ñ‡ßá ‡¶•‡¶æ‡¶ï‡ßã ‡¶≠‡¶æ‡¶≤‡ßã ‡¶•‡¶æ‡¶ï‡ßã ü•∞ \n‡¶∂‡ßÅ‡¶≠ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® @${name}!` },
      { delay: 42000, msg: `‡¶∏‡¶¨‡¶∂‡ßá‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶æ‡¶á ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶æ ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü ‡¶™‡¶æ‡¶∂‡ßá ‡¶Ü‡¶õ‡¶ø ‡¶á‡¶®‡¶∂‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶™‡¶æ‡¶∂‡ßá ‡¶™‡¶æ‡¶¨ ü•∞üòò @${name}` }
    ];

    // ‡ß©. ‡¶≤‡ßÅ‡¶™ ‡¶ö‡¶æ‡¶≤‡¶ø‡ßü‡ßá ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
    try {
      messages.forEach(({ delay, msg }) => {
        setTimeout(() => {
          sendMessage(msg);
        }, delay);
      });
    } catch (error) {
      console.error(error);
      api.sendMessage("‚ùå ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!", threadID);
    }
  }
};