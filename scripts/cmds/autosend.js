const schedule = require("node-schedule");
const chalk = require("chalk");

module.exports.config = {
  name: "autosent",
  version: "10.1.2",
  hasPermssion: 0,
  credits: "Shahadat Islam",
  description: "Automatically sends messages every hour (BD Time)",
  commandCategory: "group messenger",
  usages: "[]",
  cooldowns: 3
};

const messages = [
  { time: "12:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 12:00 AM â³\nà¦…à¦¨à§‡à¦• à¦°à¦¾à¦¤ à¦¹à¦²à§‹, à¦˜à§à¦®à¦¿à¦¯à¦¼à§‡ à¦ªà¦¡à¦¼ Bby Good Night ğŸ˜´ğŸ’¤â¤ï¸" },
  { time: "1:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 1:00 AM â³\nà¦•à¦¿à¦°à§‡ à¦¤à§à¦‡ à¦à¦–à¦¨à§‹ à¦˜à§à¦®à¦¾à¦¸ à¦¨à¦¾à¦‡? à¦¤à¦¾à¦¡à¦¼à¦¾à¦¤à¦¾à¦¡à¦¼à¦¿ à¦˜à§à¦®à¦¿à¦¯à¦¼à§‡ à¦ªà¦¡à¦¼!ğŸ˜¾ğŸ˜´ğŸ›Œ" },
  { time: "2:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 2:00 AM â³\nà¦˜à§à¦®à§‡ à¦†à¦¯à¦¼ à¦­à¦¾à¦‡! à¦à¦–à¦¨à§‹ à¦œà¦¾à¦‡à¦—à¦¾ à¦†à¦«à¦¸à§‹à¦¸ à¦•à§à¦¯à¦¾à¦¨?ğŸ˜¤ğŸ‘ŠğŸ’¤" },
  { time: "3:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 3:00 AM â³\nà¦¸à¦¬à¦¾à¦‡ à¦˜à§à¦®à¦¾à¦‡à¦¯à¦¼à¦¾ à¦—à§‡à¦›à§‡, à¦¤à§à¦‡ à¦à¦–à¦¨ à¦œà¦¾à¦‡à¦—à¦¾ à¦†à¦¸à§‹à¦¸ à¦•à§à¦¯à¦¾à¦¨?ğŸ™„ğŸŒƒğŸ›Œ" },
  { time: "4:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦­à§‹à¦° 4:00 AM â³\nà¦à¦•à¦Ÿà§ à¦ªà¦° à¦†à¦œà¦¾à¦¨ à¦¹à¦¬à§‡, à¦¸à¦®à¦¯à¦¼ à¦¹à¦¯à¦¼à§‡ à¦—à§‡à¦›à§‡à¥¤ ğŸ•ŒğŸ•‹ğŸ•“" },
  { time: "5:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦­à§‹à¦° 5:00 AM â³\nà¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¹à¦¯à¦¼à§‡ à¦—à§‡à¦›à§‡, à¦¨à¦¾à¦®à¦¾à¦œà¦Ÿà¦¾ à¦ªà¦°à§‡ à¦¨à¦¿à¦“ à¦ªà¦¿à¦“~ ğŸ•Œâœ¨ğŸ¤²ğŸ’–" },
  { time: "6:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 6:00 AM â³\nà¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§à¦¯à¦¼à¦¾à¦²à¦¾à¦‡à¦•à§à¦® Good Morning Bby! ğŸŒ…ğŸ’–ğŸ˜³" },
  { time: "7:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 7:00 AM â³\nà¦˜à§à¦® à¦­à¦¾à¦™à¦¤à§‡à¦‡ à¦®à§‹à¦¬à¦¾à¦‡à¦²! à¦¦à¦¾à¦à¦¤ à¦¬à§à¦°à¦¾à¦¶à¦Ÿà¦¾ à¦•à¦°à¦¬à¦¿ à¦¤à§‹ à¦¨à¦¾à¦•à¦¿!ğŸ›Œâ¡ï¸ğŸ“±" },
  { time: "8:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 8:00 AM â³\nà¦ªà¦¿à¦“, à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦°à§‡à¦–à§‡ à¦¦à¦¾à¦à¦¤ à¦¬à§à¦°à¦¾à¦¶ à¦•à¦°à§‡ à¦–à§‡à¦¯à¦¼à§‡ à¦¨à¦¾à¦“!ğŸ“±ğŸª¥ğŸ½ï¸" },
  { time: "9:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 9:00 AM â³\nBby, Breakfast korco?ğŸ³ğŸ¥ğŸ’–" },
  { time: "10:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 10:00 AM â³\nà¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦¤à§à¦‡ à¦†à¦œ à¦•à¦²à§‡à¦œ à¦¯à¦¾à¦¸ à¦¨à¦¾à¦‡? ğŸ˜œğŸ“šğŸ™„" },
  { time: "11:00 AM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦•à¦¾à¦² 11:00 AM â³\nà¦¨à¦¾à¦Ÿà¦• à¦•à¦® à¦•à¦° à¦ªà¦¿à¦“~ à¦¬à¦¸ à¦à¦–à¦¨ à¦¬à¦¿à¦œà¦¿ à¦†à¦›à§‡!ğŸ™„ğŸ“±ğŸ’¼" },
  { time: "12:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¦à§à¦ªà§à¦° 12:00 PM â³\nGood Afternoon! ğŸŒğŸ™ŒğŸŒ¸" },
  { time: "1:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¦à§à¦ªà§à¦° 1:00 PM â³\nà¦­à¦¨à§à¦¡ à¦•à§‹à¦¥à¦¾à¦•à¦¾à¦° à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦¬à¦¨à§à¦§ à¦•à¦°à§‡ à¦œà§‹à¦¹à¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦ªà§œà§‡ à¦¨à¦¾à¦“ğŸ˜»â£ï¸ğŸ¥°" },
  { time: "2:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¦à§à¦ªà§à¦° 2:00 PM â³\nà¦­à¦¨à§à¦¡ à¦•à§‹à¦¥à¦¾à¦•à¦¾à¦°, à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦°à¦¾à¦–! à¦—à§‹à¦¸à¦² à¦•à¦°à§‡ à¦–à¦¾à¦“à§Ÿà¦¾-à¦¦à¦¾à¦“à§Ÿà¦¾ à¦•à¦°à§‡ à¦¨à§‡ğŸ”ªğŸ›ğŸ½ï¸" },
  { time: "3:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¬à¦¿à¦•à§‡à¦² 3:00 PM â³\nJan, à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦›à¦¾à¦¡à¦¼à¦¾ à¦†à¦° à¦¦à§à¦ªà§à¦°à§‡ à¦˜à§à¦® à¦¹à¦¯à¦¼ à¦¨à¦¾â€¦.!ğŸ˜´ğŸ’”ğŸŒ™" },
  { time: "4:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¬à¦¿à¦•à§‡à¦² 4:00 PM â³\nà¦…à¦¨à§‡à¦• à¦—à¦°à¦® à¦ªà¦¡à¦¼à§‡à¦›à¦¿à¦² à¦†à¦œ! ğŸ¥µğŸŒğŸ’¦" },
  { time: "5:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¬à¦¿à¦•à§‡à¦² 5:00 PM â³\nà¦ªà¦°à¦¿à¦¸à§à¦¥à¦¿à¦¤à¦¿ à¦¯à§‡à¦®à¦¨à¦¿ à¦¹à§‹à¦• à¦¨à¦¾ à¦•à§‡à¦¨, à¦¸à¦¬ à¦¸à¦®à§Ÿ à¦¹à¦²à§‡ à¦¹à¦¾à¦¸à¦¤à§‡à¦‡ à¦¹à¦¬à§‡! ğŸ˜…ğŸ•’ğŸ™‚" },
  { time: "6:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦¨à§à¦§à§à¦¯à¦¾ 6:00 PM â³\nGood Evening Everyone! ğŸŒ†ğŸ‘ğŸ’¦" },
  { time: "7:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦¸à¦¨à§à¦§à§à¦¯à¦¾ 7:00 PM â³\nà¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦¤à§à¦‡ à¦†à¦œ à¦ªà¦¡à¦¼à¦¤à§‡ à¦¬à¦¸à¦›à¦¿à¦²à¦¿ à¦¨à¦¾à¦•à¦¿?ğŸ˜ğŸ“šğŸ¤”" },
  { time: "8:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 8:00 PM â³\nà¦“à¦‡ à¦“à¦‡, à¦à¦¤à§‹ bot bot à¦¨à¦¾ à¦•à¦°à§‡ à¦†à¦®à¦¾à¦° à¦¬à¦¸ à¦¶à¦¾à¦¹à¦¾à¦¦à¦¾à§ à¦•à§‡ à¦à¦•à¦Ÿà¦¾ à¦—à¦« à¦¦à§‡...!ğŸ«°ğŸ˜ğŸ”¥" },
  { time: "9:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 9:00 PM â³\nà¦†à¦®à¦¾à¦° cute bby à¦Ÿà¦¾à¦¹ à¦–à¦¾à¦¨à¦¾ à¦–à¦¾à¦‡à¦›à§‡...!ğŸ˜˜ğŸ½ï¸â¤ï¸" },
  { time: "10:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 10:00 PM â³\nà¦•à¦¿à¦°à§‡ à¦­à¦¨à§à¦¡, à¦–à¦¾à¦‡à¦¬à¦¿ à¦•à¦–à¦¨? à¦¸à¦¾à¦°à¦¾à¦¦à¦¿à¦¨ à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦Ÿà¦¿à¦ªà¦¸..!ğŸ˜œğŸ“±ğŸ˜¾" },
  { time: "11:00 PM", message: "à¦à¦–à¦¨ à¦¸à¦®à¦¯à¦¼ à¦°à¦¾à¦¤ 11:00 PM â³\nà¦¯à§‡ à¦›à§‡à§œà§‡ à¦—à§‡à¦›à§‡ ğŸ˜” à¦¤à¦¾à¦•à§‡ à¦­à§à¦²à§‡ à¦¯à¦¾à¦“ ğŸ™‚ à¦†à¦®à¦¾à¦° à¦¬à¦¸ à¦¶à¦¾à¦¹à¦¾à¦¦à¦¾à§ à¦à¦° à¦¸à¦¾à¦¥à§‡ à¦ªà§à¦°à§‡à¦® à¦•à¦°à§‡ à¦¤à¦¾à¦•à§‡ à¦¦à§‡à¦–à¦¿à§Ÿà§‡ à¦¦à¦¾à¦“...!ğŸ™ˆğŸ¸ğŸ¤—" }
];

async function scheduleMessages(api) {
  console.log(chalk.bold.hex("#00c300")("\n============ AUTOSENT SYSTEM LOADED (BD TIME) ============\n"));

  // Collect all group threads
  if (!global.data) global.data = {};
  if (!global.data.allThreadID) global.data.allThreadID = [];

  api.getThreadList(100, null, ["INBOX"], (err, list) => {
    if (err) return console.error(chalk.red("âš ï¸ Failed to fetch thread list:"), err);
    global.data.allThreadID = list.filter(t => t.isGroup).map(t => t.threadID);
    console.log(chalk.hex("#FFD700")(`âœ… Collected ${global.data.allThreadID.length} group IDs.\n`));

    messages.forEach(({ time, message }) => {
      const [hour, minute, period] = time.split(/[: ]/);
      let hour24 = parseInt(hour, 10);
      if (period === "PM" && hour !== "12") hour24 += 12;
      else if (period === "AM" && hour === "12") hour24 = 0;

      const rule = new schedule.RecurrenceRule();
      rule.tz = "Asia/Dhaka";
      rule.hour = hour24;
      rule.minute = parseInt(minute, 10);

      schedule.scheduleJob(rule, () => {
        global.data.allThreadID.forEach(threadID => {
          api.sendMessage(message, threadID, err => {
            if (err) console.error(chalk.red(`âŒ Failed to send message to ${threadID}: ${err.message}`));
          });
        });
      });

      console.log(chalk.hex("#00FFFF")(`ğŸ“… Scheduled message for ${time} (BDT)`));
    });
  });
}

module.exports.onStart = async function ({ api, event }) {
  scheduleMessages(api);
  api.sendMessage("âœ… Autosent system started successfully!", event.threadID);
};
